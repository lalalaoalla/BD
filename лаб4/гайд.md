
## Запрос номер 1
```
Получить наибольший объем поставки для каждого изделия и найти их среднее.
```
```
1) Получить наибольший объем поставки для каждого изделия
```
```
select n_izd, max(kol)
from spj
group by n_izd
```
```
2)Найти среднее из той поставки
```
```
select avg(a.max)
from (select n_izd, max(kol)
      from spj
      group by n_izd) a
```
**ВНИМАНИЕ** вроде работает, но я не уверена, что правильно - потому что:
<p>1) Изделия берем с таблицы spj, а в этом случае(если у нас есть изделие, для которого не делали поставки) это изделие не выведется
<br>Надо ли выводить из таблицы j?
<br> Хотя, в методе сделано так

## Запрос номер 2

```
Для указанного поставщика S* найти средний объем его поставок для каждого из изделий (для которых он поставлял детали). Вывести номер изделия, название изделия, город изделия, средний объем поставок для изделия. 
```
```
1)Найти средний объем поставок(какого-то поставщика) для каждого из изделий(для которых он поставлял детали)
```
```
select spj.n_izd, avg(kol)
from spj
where spj.n_post = 'S1'
group by spj.n_izd
```
```
2) Теперб выводим все что нужно
```
```
select j.n_izd, j.name, j.town,a.средний_объем_поставки
from (select spj.n_izd, avg(kol) as средний_объем_поставки
      from spj
      where spj.n_post = 'S*'
      group by spj.n_izd) a
join j on j.n_izd=a.n_izd
```
**Этот должен быть правильным**

## Запрос номер 3

```
Ввести номер изделия J*. Найти цвета деталей, поставлявшихся для изделия J*, и определить, какой процент поставки деталей каждого цвета составляют от общего числа поставок для изделия. Вывести цвет детали, число поставок деталей этого цвета, общее число поставок для изделия J*, процент.
```
```
1)Найдем цвета, которые поставляются для изделия J*
```
```
select distinct p.cvet
from spj
join p on p.n_det=spj.n_det
where spj.n_izd = 'J1'
```
```
2)Получим общее число поставок для этого изделия
```
```
select count(n_izd) as общее_число_поставок
from spj
where spj.n_izd = 'J1'
```
```
3) Теперь слегка модифицируем задачу 1, посчитаем кол-во поставок этого цвета
```
```
select p.cvet, count(spj.n_izd)
from spj
join p on p.n_det=spj.n_det
where spj.n_izd = 'J1'
group by p.cvet
```
```
select a.cvet, a.количество_пост_этого_цвета, b.общее_число_поставок,
 round(a.количество_пост_этого_цвета*100.0/b.общее_число_поставок,2) pr
from (select p.cvet as cvet, count(spj.n_izd) as количество_пост_этого_цвета
      from spj
      join p on p.n_det=spj.n_det
      where spj.n_izd = 'J7'
      group by p.cvet) a
cross join (select count(n_izd) as общее_число_поставок
            from spj
            where spj.n_izd = 'J7') b
```